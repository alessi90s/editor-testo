<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Editor di Testo</title>
  <!-- Foglio di stile di Quill -->
  <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
</head>
<body>

  <!-- Contenitore dell'editor -->
  <div id="editor-container" style="height: 300px;">
  </div>

  <!-- Bottoni per salvare -->
  <button id="save-pdf">Salva come PDF</button>
  <button id="save-docx">Salva come DOCX</button>

  <!-- Script delle librerie -->
  <!-- Quill -->
  <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <!-- docx.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.6.0/docx.min.js"></script>
  <!-- FileSaver.js (necessario per docx.js) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

  <!-- Script personalizzato -->
  <script>
    // Inizializzazione dell'editor Quill
    var quill = new Quill('#editor-container', {
      theme: 'snow'
    });

    // Funzione per salvare come PDF
    document.getElementById('save-pdf').addEventListener('click', function() {
      const { jsPDF } = window.jspdf;
      var doc = new jsPDF();

      // Ottieni il contenuto HTML dell'editor
      var content = quill.root.innerHTML;

      // Usa html2canvas se vuoi catturare lo stile
      doc.fromHTML(content, 15, 15, {
        'width': 170
      });

      doc.save('documento.pdf');
    });

    // Funzione per salvare come DOCX
    document.getElementById('save-docx').addEventListener('click', function() {
      const doc = new docx.Document();

      // Ottieni il testo dall'editor
      const text = quill.getText().split('\n').map(paragrafo => new docx.Paragraph(paragrafo));

      doc.addSection({ children: text });

      docx.Packer.toBlob(doc).then(blob => {
        saveAs(blob, 'documento.docx');
      });
    });
  </script>
</body>
</html>
